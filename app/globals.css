@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    font-family: 'Outfit', system-ui, sans-serif;
    background: #04040a;
    color: #ece8e0;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Subtle grain texture overlay */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9999;
    opacity: 0.025;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    background-size: 256px 256px;
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }
  ::-webkit-scrollbar-track {
    background: transparent;
  }
  ::-webkit-scrollbar-thumb {
    background: rgba(200, 165, 90, 0.15);
    border-radius: 3px;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: rgba(200, 165, 90, 0.3);
  }
}

@layer components {
  .card-surface {
    @apply bg-obsidian-850 border border-brass-faint rounded-lg;
    box-shadow:
      0 0 0 1px rgba(200, 165, 90, 0.04),
      0 2px 8px rgba(0, 0, 0, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.02);
  }

  .card-surface-hover {
    @apply card-surface transition-all duration-300;
  }
  .card-surface-hover:hover {
    border-color: rgba(200, 165, 90, 0.15);
    box-shadow:
      0 0 0 1px rgba(200, 165, 90, 0.08),
      0 4px 16px rgba(0, 0, 0, 0.4),
      0 0 24px rgba(200, 165, 90, 0.03),
      inset 0 1px 0 rgba(255, 255, 255, 0.03);
  }

  .table-header {
    @apply px-4 py-3 text-left text-xs font-semibold uppercase tracking-[0.12em] text-warm-200 font-body;
  }

  .table-cell {
    @apply px-4 py-3 font-body text-sm;
  }

  .section-heading {
    @apply font-display text-xl text-warm-white tracking-wide;
  }

  .stat-value {
    @apply font-display tabular;
  }

  .stat-label {
    @apply text-warm-300 text-[11px] font-body font-semibold uppercase tracking-[0.14em];
  }

  .badge {
    @apply inline-flex items-center px-2 py-0.5 rounded text-[11px] font-semibold uppercase tracking-wider;
  }

  .brass-line {
    @apply h-px bg-gradient-to-r from-transparent via-brass/30 to-transparent;
  }

  .micro-bar {
    @apply h-1 rounded-full transition-all duration-500;
  }

  /* CommandRail */
  .command-rail {
    @apply bg-obsidian-900 flex flex-col h-full overflow-visible;
    transition: width 200ms ease-out;
  }

  .rail-item {
    @apply flex items-center gap-3 px-5 py-2.5 relative cursor-pointer transition-colors duration-150;
  }

  .rail-item-active::before {
    content: '';
    @apply absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-5 bg-brass rounded-r;
  }

  .rail-label {
    @apply font-body text-sm whitespace-nowrap;
    transition: opacity 150ms ease-out, transform 150ms ease-out;
  }

  .rail-divider {
    @apply h-px mx-5 my-2;
    background: linear-gradient(90deg, transparent, rgba(200, 165, 90, 0.15), transparent);
  }

  /* Settings tabs */
  .settings-tab {
    @apply px-3 py-1.5 rounded-lg text-sm font-body text-warm-400
           hover:text-warm-200 transition-colors whitespace-nowrap;
  }

  .settings-tab-active {
    @apply text-brass bg-brass-faint/50 border border-brass/15;
  }
}

/* Leaflet popup overrides for dark theme */
.leaflet-popup-content-wrapper {
  background: transparent !important;
  box-shadow: none !important;
  border-radius: 8px !important;
  padding: 0 !important;
}
.leaflet-popup-content {
  margin: 0 !important;
}
.leaflet-popup-tip {
  background: #0c0c16 !important;
  border: 1px solid rgba(200, 165, 90, 0.15) !important;
  box-shadow: none !important;
}
.leaflet-container a.leaflet-popup-close-button {
  color: #7c7870 !important;
  top: 6px !important;
  right: 6px !important;
  font-size: 16px !important;
}
.leaflet-container a.leaflet-popup-close-button:hover {
  color: #c8a55a !important;
}

@layer utilities {
  /* Agent Widget â€” open/close animations */
  .agent-chat-open {
    animation: agent-chat-enter 280ms cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  }

  .agent-chat-close {
    animation: agent-chat-exit 200ms cubic-bezier(0.55, 0, 1, 0.45) forwards;
  }

  @keyframes agent-chat-enter {
    0% {
      opacity: 0;
      transform: scale(0.4) translateY(12px);
    }
    60% {
      opacity: 1;
      transform: scale(1.02) translateY(-2px);
    }
    100% {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
  }

  @keyframes agent-chat-exit {
    0% {
      opacity: 1;
      transform: scale(1) translateY(0);
    }
    100% {
      opacity: 0;
      transform: scale(0.4) translateY(12px);
    }
  }

  .tabular { font-variant-numeric: tabular-nums; }

  @keyframes slide-in-left {
    from { transform: translateX(-100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }
  .animate-slide-in-left {
    animation: slide-in-left 200ms ease-out;
  }
}
